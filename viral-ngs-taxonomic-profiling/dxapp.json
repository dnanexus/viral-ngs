{
  "name": "viral-ngs-taxonomic-profiling",
  "dxapi": "1.0.0",
  "inputSpec": [
    {
      "patterns": [ "*.bam" ],
      "label": "Mappings files",
      "help": "Files, in .bam format, that contain alignment and mapping information.",
      "name": "mappings",
      "class": "array:file"
    },
    {
      "patterns": [ "*db*.tar.gz", "*db*.tar.lz4", "*db*.tgz" ],
      "label": "Kraken database",
      "help": "A compressed archive containing a Kraken database (including database.idx, database.kdb, taxonomy/nodes.dmp and taxonomy/names.dmp).",
      "name": "database",
      "class": "file",
      "default": {"$dnanexus_link": "file-Bqy2gb00JBBzPYf3J1ZJYFGz"}
    },
    {
      "patterns": [ "*krona*.tar.lz4" ],
      "label": "Krona database",
      "help": "A compressed archive containing a taxonomy database for Krona.",
      "name": "krona_taxonomy_db",
      "class": "file",
      "default": {"$dnanexus_link": "file-BvZkvZQ0GqX2zgXY3vJ9Jf99"}
    },
    {
      "group": "Advanced",
      "help": "Extra command-line options that will be passed directly to the kraken invocation. Example: --quick --only-classified-output",
      "label": "Extra command-line options",
      "optional": true,
      "class": "string",
      "name": "extra_options"
    },
    {
      "name": "resources",
      "class": "file",
      "patterns": [ "viral-ngs-*.resources.tar.gz" ],
      "label": "A pre-built viral-ngs resources bundle",
      "default": {"$dnanexus_link": "file-BxY2vJj0q548kZkfFQV8vbPb"}
    }
  ],
  "outputSpec": [
    {
      "patterns": [
        "*.kraken-classified.txt.gz",
        "*.kraken-report.txt",
        "*.html"
      ],
      "label": "Outputs",
      "help": "Taxonomic profiling output files from Kraken and Krona, for each input mappings file.",
      "name": "outputs",
      "class": "array:file"
    }
  ],
  "runSpec": {
    "execDepends": [
      { "name": "liblz4-tool" },
      { "name": "pigz" },
      { "name": "openjdk-7-jre-headless" }
    ],
    "systemRequirements": {
      "main": {
        "instanceType": "mem3_ssd1_x32"
      }
    },
    "file": "src/viral-ngs-taxonomic-profiling.sh",
    "release": "14.04",
    "interpreter": "bash",
    "distribution": "Ubuntu"
  }
}
