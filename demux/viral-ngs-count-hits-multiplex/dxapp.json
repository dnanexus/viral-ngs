{
  "name": "viral-ngs-count-hits-multiplex",
  "title": "viral-ngs-count-hits-multiplex",
  "summary": "Take reads, align to reference with Novoalign and return aligned read counts for each reference sequence",
  "dxapi": "1.0.0",
  "version": "0.0.1",
  "categories": [],
  "inputSpec": [
    {
      "name": "in_bams",
      "label": "Input unaligned reads",
      "class": "array:file",
      "optional": false
    },
    {
      "name": "ref_fasta",
      "label": "BWA-indexed reference genome tarball",
      "class": "file",
      "optional": false,
      "default": {"$dnanexus_link": "file-Bxz9x3800Vfz7Fbz4Jyv56p8"}
    },
    {
      "name": "out_fn",
      "label": "Output filename. If per_sample_output is False, input file prefix will be prepended for disambiguation",
      "class": "string",
      "optional": true
    },
    {
      "name": "per_sample_output",
      "class": "boolean",
      "label": "Output samples in sub folders",
      "help": "Create subfolder for each sample output file",
      "default": false
    },
    {
      "name": "resources",
      "class": "file",
      "patterns": ["viral-ngs-*.resources.tar.gz"]
    },
    {
      "name": "count_hits_applet",
      "class": "applet",
      "label": "DNAnexus applet for viral-ngs-bwa-count-hits",
      "patterns": ["viral-ngs-count-hits"],
      "help": "The DNAnexus viral-ngs-count-hits applet."
    },
    {
      "name": "fastqc_applet",
      "label": "FastQC applet on DNAnexus",
      "class": "applet",
      "default": {"$dnanexus_link": "applet-BgY1x2Q087VvzyzQG1f68y0v"}
    },
    {
      "name": "contaminants_txt",
      "label": "Custom contaminants",
      "help": "A special file containing custom contaminant sequences to screen overrepresented sequences against. If left empty, a default set of contaminants that comes with the FastQC package will be used. If provided, this file must be a text file with two tab-delimited columns: name (such as 'Truseq Adapter') and DNA sequence (such as 'TATCTCGTATG').",
      "class": "file",
      "optional": true,
      "patterns": ["*.fastqc_contaminants.txt"]
    },
    {
      "name": "adapters_txt",
      "label": "Custom adapters",
      "help": "A special file containing custom adapter sequences which will be explicity searched against the library. If left empty, a default set of adapters that comes with the FastQC package will be used. If provided, this file must be a text file with two tab-delimited columns: name (such as 'Nextera Transposase Sequence') and DNA sequence (such as 'CTGTCTCTTATA').",
      "class": "file",
      "optional": true,
      "patterns": ["*.fastqc_adapters.txt"]
    },
    {
      "name": "limits_txt",
      "label": "Custom limits",
      "help": "A special file containing a set of criteria which will be used to determine the warn/error limits for the various modules, or selectively remove some modules from the output altogether. For an example of a limits file, refer to the limits.txt file in the FastQC sources.",
      "class": "file",
      "optional": true,
      "patterns": ["*.fastqc_limits.txt"]
    },
    {
      "name": "format",
      "label": "Input format",
      "help": "The format of the input file. By default FastQC will try to automatically detect the format based on the input filename. You can override this by choosing a specific format (fastq, bam, or bam_mapped). For BAM files, choose bam if you want all the entries to be processed, or bam_mapped if you want only the mapped entries to be processed.",
      "class": "string",
      "default": "auto",
      "choices": ["auto", "fastq", "bam", "bam_mapped"],
      "group": "Advanced"
    },
    {
      "name": "kmer_size",
      "label": "Kmer size",
      "help": "The kmer size that the kmer analysis module will use. This module reports overrepresented k-mers (sequences of size 'k'). This size must be between 2 and 10 (default is 7).",
      "class": "int",
      "default": 7,
      "group": "Advanced"
    },
    {
      "name": "nogroup",
      "label": "Disable grouping of bases past 50bp?",
      "help": "Disable grouping of bases for reads >50bp. All reports will show data for every base in the read. WARNING: Using this option may cause fastqc to slow down or crash if used on really long reads, and resulting plots may be too large for practical viewing.",
      "class": "boolean",
      "default": true,
      "group": "Advanced"
    },
    {
      "name": "extra_options",
      "label": "Extra command-line options",
      "help": "Extra command-line options that will be passed directly to the fastqc invocation. Example: --nofilter",
      "class": "string",
      "optional": true,
      "group": "Advanced"
    }
  ],
  "outputSpec": [
    {
      "name": "count_files",
      "label": "Output counts file",
      "class": "array:file"
    },
    {
      "name": "report_html",
      "label": "FastQC Report",
      "help": "An html file archive containing the report as generated by FastQC.",
      "class": "array:file",
      "patterns": ["*.stats-fastqc.html"]
    },
    {
      "name": "stats_txt",
      "label": "FastQC Stats",
      "help": "A text file containing the machine-readable statistics as generated by FastQC.",
      "class": "array:file",
      "patterns": ["*.stats-fastqc.txt"]
    }
  ],
  "runSpec": {
    "interpreter": "bash",
    "file": "src/viral-ngs-count-hits-multiplex.sh",
    "systemRequirements": {
      "*": {
        "instanceType": "mem1_ssd1_x4"
      }
    },
    "distribution": "Ubuntu",
    "release": "14.04",
    "timeoutPolicy": {"*": {"hours": 24}}
  },
  "access": {
    "network": [
      "*"
    ]
  },
  "authorizedUsers": []
}
